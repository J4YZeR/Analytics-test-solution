# Analytics-test-solution
Это приложение является решением тестового задания.
### Краткое описание решения
Используемый ЯП: Java 11.
Сборщик проекта: Maven.

Дефолтный адрес сервиса `localhost`, порт `8080`.

Параметры для h2 БД могут быть найдены в .properties файле приложения.

По умолчанию уведомления отправляются на адреса через `POST` запрос, используя RestTemplate.
Но создан класс, который выполняет запросы через WebClient. Реализацию способа отправки можно
поменять, заменив в классе `SendNotificationsServiceImpl` аннотацию `@Qualifier`.

Помимо минимальных требований, были также выполнены:
* Добавление альтернативного способа отправки уведомлений.
* Возможность задать отправку уведомлений с определенной периодичностью (опционально).
* Валидация переменных (опционально).
### API
Сервис имеет 2 эндпоинта:
* `/add`:
    Поддерживает только `POST` запрос, по которому сохраняет информацию о шаблоне в БД.
  
    Тело запроса должно содержать json, вида:
  ```json 
  {
  "templateId": "internshipRequest1",
  "template": "Jetbrains Internship in $teamName$ team.",
  "recipients": ["https://http1bin.org/post"],
  "valueTypes": [{"teamName":"string"}]
   }
  ```
  `valueTypes` - опциональный параметр, содержащий информацию о типе переменных.
Поддерживается 2 типа переменных:
  * `string` -
  Любая (кроме только цифр) комбинация цифр и букв или пустая строка.
  * `number` - Состоящая полностью из цифр, непустая строка. 
    
   Для любого другого типа валидатор выдает `false` на любой строке.
    
    Возвращает код `200`, в случае успешного добавления шаблона в БД.

* `/send`
    
    Поддерживает только `POST` запрос, по которому рассылает сообщения на сервера, связанные
    с id шаблона.
    
    Тело запроса должно содержать json, вида:
  ```json 
  {
    "templateId": "internshipRequest",
    "variables": [{"teamName": "Analytics"}]
  }
  ```

    Возвращает код `200` и отправленное сообщение, если все удалось отправить, а валидация
переменных прошла успешно (либо валидаторов не было).
  
    Возвращает код `400`, если валидация переменной не прошла.

    Возвращает код `404`, если шаблон с таким id не найден.
    
    Возвращает код `500`, если не удалось отправить сообщения на 1 или более серверов.
  (при этом на остальные доступные сервера сообщения отправляются).

  Также, можно указать дополнительно параметр `timeInMilliseconds`. Каждые `timeInMilliseconds` миллисекунд будет отправленно сообщения на сервера,
  связанные с шаблоном.
  
  
    

